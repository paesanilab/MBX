#include "x2b_A1B2Z2_C1D2_v1x.h" 

////////////////////////////////////////////////////////////////////////////////

namespace {

//----------------------------------------------------------------------------//

struct variable {
    double v_exp(const double& r0, const double& k,
                 const double * p1, const double * p2 );

    double v_coul(const double& r0, const double& k,
                  const double * p1, const double * p2 );
                  
    void grads(const double& gg, double * grd1, double * grd2,
               const double * p1, const double * p2);

    double g[3]; // diff(value, p1 - p2)
};

//----------------------------------------------------------------------------//

void variable::grads(const double& gg, double * grd1, double * grd2, 
                     const double * p1, const double * p2) {
    for (size_t i = 0; i < 3 ; i++) {
        double d = gg*g[i];
        grd1[i] += d;
        grd2[i] -= d;
    }
}

//----------------------------------------------------------------------------//

double variable::v_exp(const double& r0, const double& k,
                       const double * p1, const double * p2)
{
    g[0] = p1[0] - p2[0];
    g[1] = p1[1] - p2[1];
    g[2] = p1[2] - p2[2];

    const double r = std::sqrt(g[0]*g[0] + g[1]*g[1] + g[2]*g[2]);

    const double exp1 = std::exp(k*(r0 - r));
    const double gg = - k*exp1/r;

    g[0] *= gg;
    g[1] *= gg;
    g[2] *= gg;

    return exp1;
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

double variable::v_coul(const double& r0, const double& k,
                        const double * p1, const double * p2)
{
    g[0] = p1[0] - p2[0];
    g[1] = p1[1] - p2[1];
    g[2] = p1[2] - p2[2];

    const double rsq = g[0]*g[0] + g[1]*g[1] + g[2]*g[2];
    const double r = std::sqrt(rsq);

    const double exp1 = std::exp(k*(r0 - r));
    const double rinv = 1.0/r;
    const double val = exp1*rinv;

    const double gg = - (k + rinv)*val*rinv;

    g[0] *= gg;
    g[1] *= gg;
    g[2] *= gg;

    return val;
}

struct monomer {
    double oh1[3];
    double oh2[3];

    void setup(const double* ohh,
               const double& in_plane_g, const double& out_of_plane_g,
               double x1[3], double x2[3]);

    void grads(const double* g1, const double* g2,
               const double& in_plane_g, const double& out_of_plane_g,
               double* grd) const;
};

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

void monomer::setup(const double* ohh,
                    const double& in_plane_g, const double& out_of_plane_g,
                    double* x1, double* x2)
{
    for (int i = 0; i < 3; ++i) {
        oh1[i] = ohh[i + 3] - ohh[i];
        oh2[i] = ohh[i + 6] - ohh[i];
    }

    const double v[3] = {
        oh1[1]*oh2[2] - oh1[2]*oh2[1],
        oh1[2]*oh2[0] - oh1[0]*oh2[2],
        oh1[0]*oh2[1] - oh1[1]*oh2[0]
    };

    for (int i = 0; i < 3; ++i) {
        const double in_plane = ohh[i] + 0.5*in_plane_g*(oh1[i] + oh2[i]);
        const double out_of_plane = out_of_plane_g*v[i];

        x1[i] = in_plane + out_of_plane;
        x2[i] = in_plane - out_of_plane;
    }
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

void monomer::grads(const double* g1, const double* g2,
                    const double& in_plane_g, const double& out_of_plane_g,
                    double* grd) const
{
    const double gm[3] = {
        g1[0] - g2[0],
        g1[1] - g2[1],
        g1[2] - g2[2]
    };

    const double t1[3] = {
        oh2[1]*gm[2] - oh2[2]*gm[1],
        oh2[2]*gm[0] - oh2[0]*gm[2],
        oh2[0]*gm[1] - oh2[1]*gm[0]
    };

    const double t2[3] = {
        oh1[1]*gm[2] - oh1[2]*gm[1],
        oh1[2]*gm[0] - oh1[0]*gm[2],
        oh1[0]*gm[1] - oh1[1]*gm[0]
    };

    for (int i = 0; i < 3; ++i) {
        const double gsum = g1[i] + g2[i];
        const double in_plane = 0.5*in_plane_g*gsum;

        const double gh1 = in_plane + out_of_plane_g*t1[i];
        const double gh2 = in_plane - out_of_plane_g*t2[i];

        grd[i + 0] += gsum - (gh1 + gh2); // O
        grd[i + 3] += gh1; // H1
        grd[i + 6] += gh2; // H2
    }
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

//struct vsites {
//    //void TwoParticleAverageSite() {}
//    //void ThreeParticleAverageSite() {}
//    void OutOfPlaneSite(const double& w12, const double& w13,
//                        const double& wcross, const double x1[3],
//                        const double y1[3], const double y2[3],
//                        double vs[3]);
//    //void LocalCoordinatesSite{}
//};
//
//void vsites::OutOfPlaneSite(const double& w12,
//                            const double& w13,
//                            const double& wcross,
//                            const double x1[3],
//                            const double y1[3],
//                            const double y2[3],
//                            double vs[3]) {
//    double r12[3], r13[3];
//
//    for (int i = 0; i < 3; ++i) {
//        r12[i] = y1[i] - x1[i];
//        r13[i] = y2[i] - x1[i];
//    }
//                            
//    double rc[3];
//    rc[0] = r12[1]*r13[2] - r12[2]*r13[1];
//    rc[1] = r12[2]*r13[0] - r12[0]*r13[2];
//    rc[2] = r12[0]*r13[1] - r12[1]*r13[0];
//    
//    vs[0] = x1[0] + w12 * r12[0] + w13 * r13[0] + wcross * rc[0];
//    vs[1] = x1[1] + w12 * r12[1] + w13 * r13[1] + wcross * rc[1];
//    vs[2] = x1[2] + w12 * r12[2] + w13 * r13[2] + wcross * rc[2];
//}

} // namespace

////////////////////////////////////////////////////////////////////////////////

namespace x2b_A1B2Z2_C1D2_deg4 {

//----------------------------------------------------------------------------//

x2b_A1B2Z2_C1D2_v1x::x2b_A1B2Z2_C1D2_v1x(std::string mon1, std::string mon2) {

 coefficients = std::vector<double> {
-6.883520289524126e+00, // 0
 3.883559654034800e+01, // 1
 6.203129045556252e+01, // 2
-1.418406138999562e+00, // 3
-1.980883394897627e+00, // 4
-2.269389042825500e+01, // 5
-4.548845900897860e-07, // 6
-4.717900374823213e-02, // 7
-2.057962629622279e+00, // 8
-9.689840607815184e+01, // 9
-2.827989089976851e+00, // 10
-4.780848622941989e+00, // 11
 4.559682659933921e+00, // 12
 1.786660657355030e+02, // 13
 3.041504080500190e+00, // 14
 1.099911393116151e+00, // 15
 1.445872837340058e+00, // 16
 2.825430648103333e-02, // 17
-3.332970251435112e-02, // 18
 1.192209850293457e-01, // 19
-1.469550054782492e+02, // 20
-4.653069825059904e+00, // 21
-7.126228660780906e+00, // 22
-2.179038584015490e-03, // 23
 4.784447748414768e+01, // 24
 3.536534956075473e+01, // 25
-7.375633649267987e+00, // 26
 2.209502221478376e-01, // 27
-1.250586948703907e-06, // 28
 3.816774326431144e+00, // 29
 1.540672818898064e-01, // 30
-5.439515193689844e+01, // 31
-2.405464249433241e-02, // 32
 4.297461381688682e-01, // 33
 5.467044651215656e+00, // 34
 1.051887726580182e+01, // 35
-2.877955269119836e+00, // 36
 1.722522146611410e-02, // 37
 3.045590527435379e+00, // 38
 6.920396342421060e+01, // 39
 4.269051483820898e-01, // 40
 1.525812858633765e+01, // 41
 1.478102560910845e-01, // 42
 1.795365268385229e+00, // 43
-6.773601252886500e+01, // 44
 3.787577578999326e+00, // 45
-1.018340788503785e+02, // 46
 6.198546527411159e+01, // 47
-2.638205266643742e+01, // 48
-2.376542281417475e+01, // 49
-1.685355314344725e+01, // 50
 1.249810455201138e-01, // 51
 4.685681328820232e+01, // 52
 8.105548450928663e-01, // 53
 8.487663520035870e+00, // 54
-1.853983525175850e-05, // 55
-1.227300242934808e+01, // 56
-3.642604909642806e+00, // 57
-3.437751530634673e+00, // 58
-9.651325003781530e-01, // 59
 4.921441088069644e+00, // 60
 6.764399496547065e-02, // 61
 1.805668019122189e+00, // 62
 6.753773024998594e-02, // 63
-6.015776823703340e-06, // 64
 9.709063076855630e+01, // 65
 1.196431181546004e+01, // 66
 5.461770630840169e-01, // 67
-1.729167657243343e+01, // 68
 5.676615548472524e-01, // 69
-4.690921151891113e+00, // 70
 9.299254655332005e-04, // 71
 4.786510298106626e+00, // 72
 1.468618622176097e-02, // 73
 1.646429672864210e-02, // 74
-5.089369752394476e+00, // 75
 4.971800623797889e+00, // 76
-1.101748556893469e-02, // 77
 5.563502758430174e-02, // 78
-2.874648655786001e-03, // 79
-8.652676312308502e+00, // 80
 7.941942085707275e-03, // 81
-6.158824904629336e-02, // 82
-8.883861466519610e-02, // 83
 9.578134129544450e-03, // 84
 8.135125405522688e-01, // 85
-2.684500550912424e-01, // 86
 1.876792528711349e+00, // 87
 7.032589441089788e-03, // 88
-1.690464917497723e+01, // 89
-5.425441503246249e-01, // 90
-1.651616389305899e+00, // 91
-1.262224178732315e-01, // 92
-1.671726260274783e-03, // 93
-9.901219895669735e+01, // 94
 3.231915054376556e+01, // 95
-4.035139733404002e-04, // 96
 4.336801585964074e+01, // 97
 9.061107864889603e-02, // 98
 2.882597534654871e+00, // 99
-2.825267928021794e+01, // 100
 4.918587717053369e+00, // 101
 1.815991068008445e+00, // 102
-2.415711819139149e+00, // 103
-4.659393967857880e-02, // 104
-3.465471170827720e-02, // 105
 4.386015525220601e-01, // 106
-2.752638946832634e-03, // 107
-7.715013412449926e-03, // 108
-3.354120699374263e+01, // 109
-1.316134596846204e-02, // 110
-2.559408825120152e-01, // 111
 1.036856883482859e+00, // 112
 5.672839917966095e+00, // 113
 1.107814148270505e-01, // 114
-5.335844156917781e-01, // 115
 3.781370480253598e+00, // 116
 1.823733826322529e+01, // 117
-4.224467615540663e-01, // 118
-4.888066752269241e-02, // 119
-1.004802944292024e-01, // 120
 2.396329017329659e+01, // 121
-6.774776256688693e-01, // 122
-1.424046548465606e+00, // 123
 1.312223962408907e+01, // 124
 1.916488261588738e+01, // 125
-8.918348983606739e+00, // 126
 2.187523586769305e-01, // 127
-1.471042644510489e-01, // 128
 6.354471501366940e-02, // 129
 5.770283692718126e+00, // 130
-9.386650891693471e+00, // 131
 1.222116792632388e+02, // 132
-1.643626247167885e-04, // 133
 2.511473104731766e+00, // 134
-2.213446921469582e-01, // 135
 6.452409753264940e+00, // 136
-2.625919674546408e-01, // 137
 2.568355564319441e+00, // 138
-6.930846364573844e+01, // 139
-1.204703480265793e-02, // 140
 4.872745313866153e-04, // 141
 2.219381283400366e+01, // 142
 2.275257270817803e-03, // 143
-5.649129572533732e-03, // 144
-1.217430185307543e+00, // 145
-4.513078003944575e+00, // 146
 1.175471173035627e+00, // 147
 1.971896837340157e+01, // 148
 3.790291985964722e-01, // 149
 2.184027646815990e-01, // 150
 2.591442252680257e+01, // 151
-1.401820122773714e+01, // 152
 2.051537190530825e-01, // 153
 1.742909835955126e-01, // 154
 8.466904206791119e+00, // 155
 4.533683053928176e+00, // 156
-3.133789277290895e+01, // 157
 1.522325215151173e+01, // 158
-3.480845772971728e+00, // 159
 1.179522565246962e-01, // 160
-7.898608941436920e-01, // 161
 1.300169194059138e-01, // 162
-1.358686582415284e+02, // 163
 8.106686566038144e-03, // 164
 3.947732358486645e-01, // 165
 2.259032168188376e+02, // 166
 9.129607748753295e-01, // 167
 1.782998766591439e+01, // 168
 1.266583661855034e-02, // 169
-3.214289991285544e+00, // 170
-3.612682937273806e-03, // 171
-9.984334038414593e+00, // 172
 4.780918247825008e-03, // 173
 3.151000562087727e+01, // 174
 6.943496169024778e-01, // 175
-9.273005694654435e-03, // 176
-1.040305385343638e+01, // 177
 7.821093596180863e-03, // 178
 8.401961137927731e-03, // 179
-1.339127668434428e+01, // 180
-3.342629600620155e-02, // 181
-7.581477187067802e-01, // 182
 1.156964971021018e+02, // 183
 2.554237539672939e-01, // 184
-1.970178313047206e+00, // 185
-5.658810101238326e-02, // 186
-7.495483333452221e-03, // 187
 2.053719490434611e-03, // 188
-1.308916358677664e-02, // 189
-1.118236432456618e+01, // 190
-2.104223502654285e-04, // 191
 1.954567931930422e+01, // 192
 2.160177273370898e+00, // 193
-8.714581846082504e-01, // 194
 9.254640665557307e-04, // 195
-2.026448010604990e-01, // 196
-2.509894533474672e+00, // 197
-1.727750160026025e-01, // 198
-2.361150235779180e+01, // 199
-7.526184096457147e-02, // 200
-2.727388070435306e+01, // 201
 1.165764871068988e+00, // 202
 4.794479276477595e-01, // 203
 2.549277170832588e+00, // 204
-4.546029021233963e-01, // 205
-1.085458301940180e+01, // 206
 1.512295835075076e+00, // 207
 9.946920251891478e-03, // 208
 8.076801685919323e-03, // 209
 7.736697674213866e-02, // 210
 1.053815432563234e-02, // 211
 1.139802810148822e+00, // 212
-1.277297745177825e-02, // 213
 5.017893087963022e-01, // 214
 2.136756329897304e+00, // 215
 3.610174665661699e+01, // 216
 1.321992995199312e-02, // 217
-1.338300102557708e-02, // 218
-3.349117831800155e-02, // 219
 1.822980577704617e-03, // 220
-1.653778796151285e+01, // 221
 6.535664704472477e-04, // 222
 5.039368975775834e-01, // 223
-3.521622635187580e+01, // 224
 1.790666568282647e+00, // 225
 1.400171337800379e-03, // 226
-2.928955798718407e+01, // 227
-5.601144654493527e-03, // 228
-9.160556515254712e-01, // 229
-1.235587263924621e-04, // 230
 1.739415161724765e-03, // 231
-5.083996667658635e-02, // 232
 5.823676324410106e-01, // 233
 1.108469877565895e-05, // 234
-1.013134700477634e+01, // 235
 2.676892566812509e-02, // 236
-1.828627275500346e+01, // 237
 1.927306509677279e+00, // 238
 2.275142663597536e-01, // 239
-7.505984330503777e-04, // 240
 2.659093923392831e+01, // 241
 7.565790747343881e+00, // 242
-4.487371768313776e+01, // 243
-1.150034808007909e-01, // 244
 1.990793761320608e+01, // 245
-3.134025060767712e-04, // 246
-3.912627586154225e-01, // 247
 4.703476457776177e-04, // 248
 1.354078732031125e-03, // 249
 2.933913755059607e+00, // 250
 1.686870479847172e+01, // 251
 5.390791485461927e-02, // 252
-1.328710223767973e+01, // 253
-7.759545459054928e+00, // 254
 4.194881582110310e+01, // 255
-1.349668565765237e+00, // 256
-6.483322373675410e+00, // 257
-1.064855082200875e-02, // 258
 2.186747814605487e-02, // 259
 1.163018707127776e+01, // 260
 7.432643779256153e-03, // 261
 2.125137971520430e+01, // 262
-5.864019102483950e-02, // 263
-6.707808992494923e+01, // 264
-9.842193776507105e-02, // 265
-4.530756606887383e-05, // 266
 5.149982974057091e-03, // 267
-1.410421708855287e-03, // 268
 4.414620342414592e-02, // 269
 1.559530429467248e-02, // 270
-4.622252434524957e+00, // 271
-2.317604860458341e-02, // 272
 2.673963579931866e+00, // 273
-7.163166817470128e-01, // 274
 3.571230135364787e+01, // 275
-2.846746573620938e-01, // 276
 3.206859697832577e-01, // 277
-2.136434761894525e-02, // 278
-5.432616765541012e+00, // 279
-6.960624348742106e+00, // 280
 3.550255367412401e-02, // 281
-1.786807700427759e+00, // 282
 1.706051746230662e+01, // 283
 2.210529199182483e+00, // 284
 1.305880007014715e-01, // 285
-8.927707218254902e-03, // 286
-2.604500105481660e-01, // 287
-1.099707115320705e-01, // 288
 1.342446411213974e-02, // 289
 7.113475458338415e-03, // 290
 3.388944922442984e-04, // 291
-4.773508163579982e+00, // 292
-1.244758817900876e-01, // 293
-8.439801022764067e-01, // 294
 3.424676321351425e-02, // 295
 1.122744021947498e-01, // 296
 1.017228328540226e+00, // 297
 4.082896203037475e-01, // 298
-1.831221203652484e+00, // 299
 5.191636789791762e+00, // 300
-4.237479927384819e+00, // 301
 6.004538908025757e-01, // 302
-1.325903590857922e-02, // 303
-2.211046771204122e+00, // 304
 2.688711624735994e+00, // 305
-6.516887504796703e-01, // 306
-8.259473122110089e+00, // 307
-2.025523451575020e+00, // 308
 1.356135943478534e-01, // 309
 2.322438816762527e-01, // 310
 3.803863655940731e-01, // 311
-2.878896340918083e-02, // 312
 2.248035928706843e+01, // 313
-8.217353905706833e+00, // 314
 1.999337911614779e+01, // 315
 1.674955126238648e-01, // 316
 3.448117681551076e+00, // 317
-1.135650492724409e-02, // 318
 7.541238898365404e+01, // 319
-8.227472547128068e-03, // 320
-2.365731069283130e-01, // 321
 4.406482204240182e+00, // 322
-5.105165912216057e+00, // 323
-4.155985704947567e-03, // 324
 9.675127691032451e-01, // 325
-8.928290334187457e-03, // 326
 4.294244218273626e-01, // 327
-2.457768494243903e-02, // 328
-6.817953313475149e-01, // 329
-4.037591781624028e+00, // 330
 8.494298641931127e-01, // 331
-1.709618557561582e-02, // 332
 1.146457822654520e+01, // 333
-5.866155021922136e-02, // 334
-9.420372346511217e-03, // 335
 1.425819482466726e+00, // 336
 7.458040229586044e-03, // 337
 1.182388499262324e+00, // 338
-2.556411538508201e-01, // 339
 5.029168213013978e+01, // 340
-3.523436553579229e-01, // 341
 1.015778491394234e-02, // 342
-4.875570099575412e-02, // 343
-2.752187509488244e+00, // 344
-9.341147701060838e+01, // 345
-1.344973678367291e+01, // 346
 1.866555054824352e-02, // 347
 1.355282983385480e+01, // 348
-1.132099713792303e+01, // 349
-5.546178507021677e-01, // 350
 2.820684061666036e-01, // 351
 1.396602549690693e+00, // 352
 6.363948038268590e-04, // 353
-1.630988409769030e-01, // 354
-1.005575572018356e-03, // 355
 9.915392889230947e+00, // 356
 1.186795258505273e-03, // 357
-1.841019302359395e+02, // 358
-2.330749652014866e+01, // 359
-4.010536091805485e+00, // 360
 2.750214149459703e-01, // 361
 4.599246575833692e-02, // 362
-2.463566718942725e+01, // 363
 5.651421888298823e+00, // 364
-2.993902959973482e-01, // 365
-9.531106334673714e+01, // 366
-1.945680908613258e-01, // 367
 9.587820015216425e-01, // 368
 1.837523366869593e-01, // 369
 1.039524053433837e+00, // 370
 1.166362900901056e+00, // 371
-1.105420785785379e+01, // 372
-7.640700824062772e-01, // 373
 1.290043328613543e+02, // 374
-3.687869522687732e+00, // 375
-1.333293968779584e+02, // 376
-6.798518302205356e+01, // 377
-2.364800719137087e+01, // 378
-1.553792519390724e+01, // 379
 6.305224107323587e+01, // 380
-3.682055194900818e-02, // 381
 1.381683294801012e-02, // 382
 1.072380520862593e-04, // 383
-4.313047862333877e-01, // 384
-4.794488776539133e-04, // 385
 8.180320758363188e-03, // 386
 1.854627528774489e+00, // 387
-1.103316163782987e-03, // 388
-3.513553838315135e-04, // 389
 1.178441635068028e-02, // 390
 7.394604309709635e+00, // 391
 3.862262387103456e-05, // 392
-2.609861694667488e-03, // 393
 4.506654584595273e-05, // 394
-3.415166662431516e-03, // 395
-1.990770366813930e+00, // 396
 3.849686105692130e-04, // 397
 9.436494107531090e-01, // 398
 1.583579265262479e-03, // 399
-9.674607955647086e-04, // 400
 8.498418024237119e-01, // 401
 2.020102257903918e-04, // 402
-6.940891516756183e-03, // 403
 5.227122033183531e-04, // 404
-1.165555093259785e-03, // 405
 1.657568517012565e+01, // 406
-3.572012095142345e-02, // 407
 1.698465456782282e-04, // 408
 8.222607458029775e-03, // 409
 1.776671966200959e-05, // 410
 1.058934396821992e-03, // 411
-7.719019294299287e-04, // 412
 7.737366544727506e-03, // 413
 2.238072424361372e-03, // 414
-3.028059070052250e-02, // 415
 1.137565516451240e-01, // 416
-1.751407137431605e-04, // 417
-1.855392654475284e-03, // 418
-1.088304099781178e+00, // 419
 3.504998268052784e-03, // 420
-7.434284423207500e-02, // 421
-2.304286234332920e-03, // 422
 4.952849288357919e-03, // 423
-1.859854008235496e-01, // 424
 5.145670765153197e+00, // 425
-6.980070705669272e-02, // 426
 2.026764443875809e+00, // 427
 2.199434913892417e-02, // 428
 7.893768815432152e-06, // 429
-2.352879779669216e-04, // 430
 2.411959299395601e-01, // 431
-3.447340138971092e-07, // 432
-1.465308532245381e-02, // 433
 5.251919843540849e-06, // 434
 1.284190518791969e-06, // 435
 1.310290820613232e-03, // 436
 1.611411348439103e-03, // 437
 6.119620539809106e-02, // 438
-5.939743611030807e-04, // 439
 2.780073890305889e-06, // 440
 1.561806395413959e-02, // 441
-6.236744894574805e-04, // 442
 5.012203619757941e-04, // 443
-9.490993803460004e-04, // 444
 1.685512693628565e-04, // 445
-8.742580324596672e+00, // 446
 1.962055042988263e+00, // 447
 1.308292133959979e-01, // 448
-1.774836314046628e-06, // 449
 5.720579133158660e-06, // 450
 9.782093311174083e-04, // 451
 3.523489448122794e-01, // 452
-6.069139451538944e-01, // 453
-2.893705328916204e+00, // 454
-9.840840228922178e-03, // 455
-1.474453365159649e+00, // 456
-3.429783101888428e-03, // 457
 5.003740299933256e-02, // 458
-8.153470513457483e-03, // 459
-9.686040755448057e-02, // 460
-2.116794629934642e-04, // 461
-1.218556545738195e+00, // 462
 2.323439326913931e+01, // 463
 1.512876599236276e-01, // 464
-7.308753378510175e-05, // 465
-2.946702715511959e+00, // 466
 1.238871242350063e-06, // 467
-8.608823320647230e-02, // 468
-1.079647305211218e-03, // 469
-1.654601073065617e-01, // 470
-5.889156133667480e-04, // 471
 4.183680054149939e-01, // 472
 3.314316695108516e-01, // 473
-9.451206137895235e-04, // 474
-2.828269598372706e-01, // 475
 9.262857329241024e-03, // 476
-1.139879529825017e-01, // 477
-7.171128229856462e-01, // 478
 7.682333794044795e-06, // 479
-3.730171183413068e-01, // 480
 1.921190737631358e-01, // 481
-8.265303544055498e-03, // 482
-4.350546526910018e-03, // 483
-1.337144225224643e+00, // 484
 4.618250585464229e-03, // 485
 3.524242252252031e-05, // 486
-7.560645555505168e-01, // 487
-3.905333855328509e-01, // 488
 8.461241965779452e-03, // 489
-3.426930476707862e-05, // 490
-1.322172357466834e-05, // 491
-1.939671007814119e-02, // 492
 4.032294992475882e+00, // 493
 1.402143991759818e-05, // 494
 1.194604549484424e-01, // 495
 1.717379215966024e-01, // 496
 1.476781267602871e-05, // 497
 3.522376826914529e-02, // 498
 1.186735891976042e-06, // 499
-8.754200489982162e-04, // 500
 1.465369653232386e-02, // 501
-4.336006238756170e-04, // 502
 4.357823585360009e-01, // 503
 4.729606893083042e-04, // 504
-1.670502082201927e-01, // 505
 1.429182955517506e-01, // 506
-1.087555611416386e-07, // 507
 6.682789742436874e-06, // 508
 7.099389371347795e-02, // 509
-3.983292893605464e-05, // 510
 2.260880035261935e-01, // 511
-7.351795729693687e-03, // 512
 8.703652861049122e-02, // 513
 3.052377858611478e-05, // 514
 1.314553078366941e-05, // 515
 3.773203033655557e-04, // 516
 8.331651939886992e+00, // 517
-2.630221365563698e-03, // 518
 6.070040433544178e-01, // 519
-4.674849472904114e-06, // 520
-2.640993954646589e-03, // 521
-2.686485652707772e-03, // 522
-3.266838416077077e-04, // 523
-4.456600235782889e-07, // 524
-4.142272352624284e-05, // 525
 1.129700595602479e-02, // 526
 2.263917628700538e-03, // 527
 1.194693735652013e-02, // 528
 7.090177051191661e-02, // 529
-3.802400892451303e-05, // 530
 1.204143208168955e+01, // 531
-9.517924804800046e-07, // 532
-6.778498631017593e-05, // 533
 5.786340372561464e-04, // 534
 1.119167218179132e-03, // 535
 9.063663316365347e-02, // 536
 4.911735577780308e-04, // 537
-1.425333692284422e-02, // 538
 1.109860226457504e-02, // 539
 1.680133036910875e+00, // 540
 7.782430823242140e-02, // 541
-7.818922583585023e-03, // 542
-3.654457006922857e-02, // 543
 3.112322567770354e-03, // 544
-4.337902406160568e-04, // 545
 3.254848418768092e-05, // 546
 2.663360076595046e-06, // 547
 1.595524662658949e-01, // 548
 4.752082429383083e-03, // 549
 1.021785474993647e-04, // 550
 1.429672620688589e-01, // 551
-2.253617787186893e-05, // 552
-1.054075973909946e+00, // 553
 2.805684114608602e-03, // 554
-1.060496860826042e-04, // 555
-1.536200215934212e-02, // 556
 3.591898726109296e-01, // 557
-2.259632786917552e-02, // 558
-6.752434105640215e-03, // 559
-2.405559107681989e-07, // 560
-1.343965219463456e+00, // 561
-3.029383353135419e-02, // 562
-3.232797008496800e-01, // 563
 4.067380621818921e-03, // 564
-5.679600240182943e-03, // 565
 1.569113567774939e-03, // 566
 6.579264548402023e-05, // 567
 4.693748624135545e-01, // 568
-3.036304427364111e-04, // 569
-2.004225550033356e-01, // 570
-1.226102812164897e-02, // 571
-1.330570377024376e-05, // 572
-1.845031710579380e-01, // 573
-1.327640922839763e-02, // 574
-8.473827862186915e-04, // 575
-7.575627257280945e-04, // 576
-2.417055409899392e-02, // 577
 2.594686016324030e-02, // 578
-3.336830370082209e-01, // 579
-1.872331371315526e-05, // 580
-2.126973351680424e+01, // 581
-1.425679260529826e-03, // 582
 1.121250953779531e+00, // 583
-1.365569479881072e-01, // 584
 4.903601649948747e-02, // 585
-5.146313620046427e+00, // 586
 6.203658366292718e-05, // 587
-1.289875724821770e+00, // 588
-1.462839027287086e-07, // 589
-2.992187658564971e-04, // 590
-5.296569511336096e-09, // 591
 3.727089469888276e+00, // 592
 1.508678467259695e-02, // 593
 1.499299721885190e+00, // 594
 3.450698605664409e-03, // 595
 4.180103434665391e-03, // 596
 1.016813303638141e+00, // 597
 1.603584133454454e-03, // 598
-5.763856765060556e-02, // 599
 1.934336751190089e-05, // 600
 6.544710054014173e-02, // 601
 4.476823597853485e+00, // 602
 2.282131009841782e-05, // 603
 1.065618327181775e+01, // 604
-9.803131239001233e-06, // 605
-8.337847381846193e-04, // 606
 9.167666050542748e-03, // 607
-1.567978933986164e+00, // 608
-8.886813137669756e-05, // 609
 1.981251652078697e-02, // 610
 1.320606123863559e-04, // 611
-2.578813586741311e-02, // 612
-2.567917056965042e+00, // 613
-2.863134794635608e-03, // 614
 4.735393867367790e-02, // 615
-4.395478191483159e-07, // 616
 1.290960075275642e-04, // 617
-7.424409895627571e-02, // 618
-7.646944148072395e-01, // 619
 1.081195345571118e-06, // 620
-6.953083663315234e-01, // 621
-2.998705775654103e-05, // 622
-7.997949692085804e+01, // 623
-8.954495974062181e-04, // 624
-5.212448514407224e+00, // 625
-1.548620806358201e-05, // 626
 3.333392434530462e-06, // 627
-8.649275460762317e-01, // 628
-4.590743837448547e+00, // 629
-7.710742634475765e-04, // 630
-5.199466051002863e-03, // 631
 1.572425306947075e-01, // 632
 5.201192581079836e-06, // 633
-1.128982162291129e-01, // 634
 3.090408783914295e-04, // 635
-1.785337852790712e+01, // 636
-3.787666077121103e+01, // 637
 1.507543343351038e+00, // 638
-2.323779664843835e+00, // 639
-5.208136560273011e-04, // 640
 2.269315910011596e-04, // 641
 2.039769806101188e-05, // 642
 6.002300310942129e-04, // 643
 6.124947311019117e-02, // 644
 5.519301139124441e+00, // 645
-1.078476213198450e-05, // 646
 3.349067375017113e-07, // 647
-4.366571188210617e-04, // 648
-1.455734450185498e-01, // 649
-6.967651976294387e-04, // 650
 1.759239274527847e-03, // 651
 3.407373816426860e-02, // 652
-1.015046458010074e+00, // 653
-3.734309785272794e+00, // 654
 2.213091910584032e+01, // 655
 2.539154039736040e-02, // 656
 6.230165360486515e-02, // 657
 8.376431151144363e+00, // 658
 1.417431899223530e-02, // 659
-5.672698365854088e-02, // 660
 1.429809991163617e-03, // 661
-4.289476166504928e+00, // 662
-2.199175716243392e-02, // 663
 1.047324215573902e+00, // 664
 6.331742646631461e-01, // 665
-1.361998920189482e-02, // 666
 3.230432916534799e-01, // 667
-4.459077250736167e-03, // 668
-1.749586141355496e-04, // 669
-1.755268984507738e-03, // 670
-1.230512654353051e-03, // 671
 3.465222149558158e-04, // 672
 1.129899334083787e-03, // 673
 4.672435919474519e-02, // 674
 5.241821186076278e-01, // 675
 4.345938701528906e-05, // 676
-4.571482801224301e-02, // 677
-3.540518540632157e-04, // 678
 5.228610427091120e-03, // 679
-3.141311184305497e-02, // 680
-1.243061365798595e+01, // 681
-2.615540376548516e-02, // 682
-2.846134295447028e-05, // 683
 1.220393492682037e-02, // 684
 9.002145244645633e-04, // 685
 2.906659498448078e-05, // 686
-9.097756963330682e-04, // 687
 3.594809332259888e-03, // 688
 3.633801363034777e-05, // 689
-4.473568885841214e-03, // 690
 3.349174044674345e-04, // 691
 5.711148582555439e-02, // 692
 1.792583282793191e-02, // 693
 9.915247302402222e-04, // 694
 2.833647768458205e-02, // 695
 1.199731656984909e-02, // 696
-5.070769644832888e-05, // 697
-1.070696179478184e-02, // 698
 8.045515191184851e-05, // 699
 2.713345586229024e-04, // 700
 3.697722026140673e+00, // 701
-2.465128181961657e+00, // 702
 2.738697972684250e-05, // 703
 3.315834213376229e-02, // 704
-1.370431234912310e-03, // 705
 2.566728380266856e-03, // 706
-5.334083986810685e-04, // 707
-5.492104207406128e-07, // 708
-2.667916441661142e-01, // 709
-6.716564075278898e-02, // 710
-2.489358731587437e+00, // 711
 3.192282568948677e-01, // 712
 7.226090025237291e-04, // 713
 4.955608972499849e-05, // 714
-5.957583555398792e-06, // 715
 7.238892349563957e-03, // 716
-6.212116586048400e-02, // 717
-2.679905764318515e-03, // 718
 1.994888554639991e+00, // 719
-1.857728669558064e-07, // 720
 3.343436561445716e-01, // 721
-5.352799983916393e-03, // 722
-1.009161300899052e-02, // 723
-2.286818269603210e-02, // 724
-4.022043491209092e-04, // 725
-1.258482283671721e-03, // 726
 8.459307792993420e-03, // 727
 4.302484249646244e-06, // 728
 1.461383636508962e-06, // 729
-7.813483387254692e-04, // 730
-2.600151227697056e+01, // 731
 9.685178085296264e-01, // 732
 1.963739760467965e-05, // 733
-1.621566831784455e-03, // 734
 9.034505438077531e-04, // 735
-3.513940181144323e-04, // 736
-7.324346579248930e-05, // 737
-3.507054592880571e+00, // 738
-1.117333951376439e-02, // 739
-6.448112762467010e-01, // 740
 1.304513816710966e+00, // 741
-1.136690520498736e-01, // 742
 5.331216647757291e+00, // 743
-1.904042283109398e-04, // 744
-1.294456074433381e-01, // 745
-1.302081082960647e-01, // 746
-2.723548166449699e+00, // 747
 1.081974623656033e+00, // 748
-5.986508010436207e-05, // 749
 2.718915120075829e-04, // 750
-8.372006718020561e-02, // 751
 8.682466302361880e-05, // 752
-1.039206661642796e-02, // 753
 6.710780866161514e-04, // 754
-4.897111331825450e-03, // 755
-1.163003501737757e-01, // 756
 3.562699798105915e-01, // 757
-8.217241923350728e-02, // 758
-3.161096169589590e-03, // 759
-1.644283300625794e-02, // 760
-2.226298849049226e-01, // 761
 7.346089413849247e-04, // 762
-1.568197291543316e+00, // 763
-1.739470976551787e-01, // 764
 4.841791125211359e-02, // 765
-1.500950938514244e-02, // 766
-1.614155995076362e+00, // 767
 2.302375209085130e-05, // 768
 1.643671833408490e-02, // 769
-3.212713943730466e-03, // 770
-1.235932221187756e+01, // 771
 3.593630159950659e-01, // 772
 3.816580059250533e+00, // 773
-8.401539990327253e+00, // 774
 2.615170077631836e-04, // 775
-1.940438174070422e-05, // 776
-5.134895414705318e+00, // 777
 1.459476147420532e-03, // 778
-8.365001783749522e-04, // 779
 3.990340296723804e-03, // 780
-8.952626399160338e-01, // 781
-1.834632265655118e-02, // 782
 2.473369918181149e+00, // 783
-2.425914976836420e-03, // 784
-3.809170231810187e-05, // 785
-6.335821254195560e-03, // 786
 2.142337227119189e-02, // 787
-6.102221810980207e-06, // 788
 5.352763631748866e-02, // 789
 1.100997477419526e+01, // 790
 1.284125216952859e+00, // 791
-2.759892733555715e-04, // 792
 3.744374584077623e-03, // 793
-1.015565906647794e-04, // 794
-3.007789927494273e+00, // 795
-4.061837003587257e-01, // 796
-5.296914102914447e-06, // 797
 6.377208553229087e-01, // 798
 7.647665185446713e-03, // 799
-1.311142558246409e-01, // 800
 1.685623533926943e-01, // 801
-1.188274336918587e-02, // 802
-2.625524666738169e-04, // 803
 1.160326480515882e-05, // 804
 3.584535990392106e-05, // 805
-9.907620345054990e+00, // 806
 1.881659059380400e-02, // 807
 6.174524705864128e-04, // 808
-2.496338257093229e-02, // 809
-2.299082323563978e+00, // 810
-6.555150157430332e-01, // 811
-5.524826436159551e+00, // 812
-4.972161477332048e-02, // 813
 2.663009850219881e-01, // 814
-1.538457582457266e-05, // 815
 3.140561395719897e-01, // 816
-4.611988877573165e-04, // 817
 2.448468128580010e-03, // 818
-8.421545625506986e-05, // 819
 4.124678256276206e-04, // 820
 3.167401686109506e-01, // 821
-1.235457766355670e+01, // 822
 1.056148149878542e-03, // 823
 4.275512368266273e-05, // 824
-5.779334738789166e+00, // 825
-3.783626848714814e-02, // 826
-4.616697269588714e+01, // 827
-1.952564041008466e-06, // 828
-1.353891933852659e-02, // 829
 3.571680194822546e-03, // 830
 5.864634865514549e-01, // 831
-4.004751333388553e-02, // 832
 1.523254785459540e-04, // 833
 6.954941090904335e-02, // 834
-1.830248487513050e-03, // 835
-5.250014674246739e+00, // 836
 2.966032189442491e-05, // 837
-1.063058052331760e+00, // 838
-2.664026389704672e-02, // 839
 1.196149437201628e+01, // 840
 3.987015602966882e-03, // 841
-5.065209241643320e-06, // 842
 1.238515755955376e-01, // 843
-1.458629904166728e-04, // 844
-1.409887921404627e-04, // 845
-4.210552409906678e-05, // 846
 1.491603616497288e+00, // 847
-3.202389025499533e-03, // 848
-1.023113231908967e+00, // 849
 5.552636311968209e-02, // 850
 3.826718560944043e-02, // 851
 1.450830413174727e-03, // 852
 2.889936039410319e-04, // 853
 1.925597537454980e-04, // 854
 1.402409225097687e-01, // 855
-1.416700171017037e-02, // 856
-1.361792697896778e-03, // 857
-4.050874558852922e-03, // 858
 1.483067577745859e+00, // 859
-4.614683503465629e-01, // 860
-4.713325190045472e+00, // 861
-1.416670889416873e+00, // 862
-2.860586339488500e-01, // 863
-2.944383831860910e-02, // 864
 2.733806871261803e-02, // 865
 1.622150500941911e+01, // 866
 6.544983520807464e+00, // 867
 1.329122824269164e-03, // 868
 7.984787021700213e-02, // 869
 7.719053432160162e-01, // 870
 5.813109139759166e-01, // 871
-1.231299772855031e+00, // 872
 2.342486011489671e-01, // 873
 3.733015920613116e-01, // 874
 1.494911146640218e-01, // 875
 5.329674775544414e-02, // 876
 2.997340978972748e-01, // 877
 2.778070023962517e+01, // 878
 1.539071900833457e-02, // 879
 3.605973935790767e-04, // 880
-3.917093488430703e-03, // 881
 1.151884283314798e-04, // 882
 1.521397012095355e-01, // 883
-1.220916735984062e+00, // 884
 9.072672355328886e-04, // 885
-1.466501779366779e+00, // 886
-1.744259848917782e+00, // 887
-6.725669190666806e+00, // 888
-1.026206141679031e-03, // 889
-2.720951834962589e+00, // 890
 8.107749465198670e-02, // 891
-2.528895256601801e-01, // 892
-6.745363754349107e-07, // 893
 4.799775707762872e+00, // 894
 3.649819135838486e-05, // 895
 5.149024960352020e-03, // 896
-2.853822116563569e-04, // 897
-5.617074106789340e-03, // 898
-4.555002087261512e-02, // 899
-5.788681308032335e-01, // 900
-1.518801783378747e-04, // 901
-1.662275291367245e-01, // 902
-1.778932784711554e-04, // 903
 2.936422621098634e+00, // 904
-1.422607264920504e-02, // 905
-1.837069014787613e+00, // 906
-3.420898031386158e-01, // 907
-1.406186476785107e-03, // 908
-9.483148999620350e-03, // 909
 9.645032988908768e-04, // 910
-5.644026749082427e+00, // 911
 3.844314187834437e-02, // 912
 2.586224233402791e-04, // 913
 4.626630006491174e-02, // 914
-1.918277286416747e+00, // 915
-1.318631540923250e-06, // 916
-1.702826747602378e-01, // 917
-2.799279186576647e-07, // 918
-1.111268199245079e-01, // 919
 7.350801968432391e-03, // 920
 9.582861443949410e-02, // 921
-1.111015555987422e-01, // 922
-1.220826378456851e+01, // 923
-7.703733708609294e-02, // 924
 3.566552086676937e+01, // 925
-3.877999366239827e-04, // 926
-2.417840190375715e+00, // 927
-3.370677630666909e-01, // 928
-8.248592433665833e-05, // 929
 1.936912620418864e+00, // 930
 2.880647090563350e-04, // 931
-1.525807728526310e-03, // 932
-1.135988752211089e-04, // 933
-7.414853867930760e-02, // 934
 7.670875149421800e-06, // 935
 1.315302845930263e-05, // 936
 1.709737725304908e-03, // 937
-7.991971173115235e-04, // 938
 7.237641207226020e-02, // 939
 5.116662196677400e+00, // 940
-1.815177146567952e+00, // 941
 1.025260212556871e+00, // 942
 2.610092516214124e-02, // 943
-6.472568710670970e-01, // 944
-6.731982526995083e-01, // 945
 5.982901280251319e-01, // 946
 1.755012499577417e-03, // 947
 6.495195599723449e-01, // 948
 2.375470341947038e-05, // 949
 1.753516468679974e+01, // 950
-1.688800048922426e-05, // 951
 1.617506315032309e-01, // 952
-2.091059113117268e-03, // 953
-1.505441037614928e-03, // 954
 7.068798913102087e-08, // 955
 1.565253476683413e+00, // 956
 2.745253745537721e-01, // 957
-5.780308473525231e-02, // 958
 8.267120210094141e-06, // 959
-2.008537455916183e+00, // 960
-4.941619925305938e-03, // 961
-1.142422978989537e+00, // 962
-1.635167423984947e-03, // 963
 2.121160963785861e-02, // 964
 3.549236179298398e-03, // 965
-1.351449508797486e+00, // 966
-1.231439719286295e-04, // 967
-1.447237682368898e-04, // 968
 2.579312491739988e-04, // 969
 1.905059034699803e-03, // 970
 5.992759497598079e-01, // 971
-6.155668292257234e-03, // 972
-4.234430825847352e-01, // 973
 5.083619337011403e-04, // 974
 1.100071232052918e-01, // 975
-1.481499916012981e-04, // 976
-4.416232373106086e-03, // 977
 8.197988886810968e-08, // 978
-4.292511917992672e-02, // 979
 2.940209173784441e-02, // 980
-2.396126644571598e-01, // 981
-9.965734620514595e-03, // 982
-8.369974014887925e-03, // 983
 1.264896861175870e-03, // 984
 3.146157714225349e+00, // 985
-1.209592731898325e-01, // 986
-5.895048718376406e-05, // 987
-1.116100452904785e-02, // 988
 5.099919222484187e-02, // 989
 1.315086847617871e-02, // 990
-5.311063537172547e-05, // 991
 9.092117295097676e-02, // 992
-1.204764233995852e+00, // 993
 4.345213764899934e-02, // 994
 5.165226183749452e-02, // 995
-1.650077400839743e-03, // 996
 5.311276922849525e-06, // 997
 1.734856269353521e+00, // 998
-1.040794486704001e-03, // 999
 1.478728407859859e-01, // 1000
 1.246892815559106e-02, // 1001
-5.384577244894037e-01, // 1002
-2.940203615137272e+01, // 1003
-1.543092906310070e-02, // 1004
 8.395567627562191e-03, // 1005
 4.955425824066678e+01, // 1006
 4.560962071786304e+00, // 1007
-4.475213073612735e-04, // 1008
-2.006547929512389e-04, // 1009
 7.587132048745694e-02, // 1010
-5.159966645606910e-04, // 1011
-1.041750064113049e-02, // 1012
-4.847086973098921e-02, // 1013
 5.310119240995276e-05, // 1014
-5.475642812628720e+00, // 1015
 5.060724541524508e-02, // 1016
 1.826139917156247e+01, // 1017
-4.754572797219761e-01, // 1018
 6.297731122038619e-01, // 1019
 5.586681676460370e+00, // 1020
-4.395279821322171e-09, // 1021
 1.532381948058789e-01, // 1022
-1.693482639488151e-05, // 1023
-3.744367559405909e-01, // 1024
-8.148777171326455e-06, // 1025
-1.422112591902853e-02, // 1026
-1.407552054316138e-04, // 1027
 1.187106254516255e-02, // 1028
 2.801424766112270e-01, // 1029
-4.333935548985716e-01, // 1030
-4.074903137416996e-03, // 1031
 8.373940477751198e-04, // 1032
-4.333166116633092e-01, // 1033
 2.066888081542325e-06, // 1034
 8.852396139036664e-02, // 1035
 5.101394278994540e-03, // 1036
 4.078135064674543e-03, // 1037
 4.903079101714500e-01, // 1038
-9.190986381090388e-02, // 1039
-3.081131549810408e-05, // 1040
-1.586871795093341e-01, // 1041
-2.826775255038590e-05, // 1042
-2.084034772711978e-03, // 1043
 8.902403660076092e-03, // 1044
 4.959169271585405e-03, // 1045
 9.703924275278802e-04, // 1046
-7.232651842553045e-06, // 1047
-5.191902592277409e-02, // 1048
 1.308414714696993e-01, // 1049
 2.429299904969222e-01, // 1050
-7.067448093807123e-02, // 1051
-6.547143528371360e-01, // 1052
-6.502239518500537e-09, // 1053
-2.844276189726112e+00, // 1054
 9.278470065542700e-01, // 1055
 9.839834252782942e-01, // 1056
 2.115828274926479e-04, // 1057
 6.302000372992579e-02, // 1058
-1.758696535344190e-01, // 1059
 3.226940795804122e-03, // 1060
 1.141971422448813e-03, // 1061
 5.244643907211954e-06, // 1062
 1.463757436102107e-05, // 1063
-1.424488625657422e-03, // 1064
-1.766639271371511e-05, // 1065
-8.654695154101965e-05, // 1066
-4.378753646309413e-04, // 1067
 5.375165489214200e+00, // 1068
 1.835413634591818e+00, // 1069
-1.815715896921641e-01, // 1070
-1.156433572926681e-02, // 1071
-1.901304013592540e-04, // 1072
 1.074484413042573e-08, // 1073
 4.392708218949569e+00, // 1074
-1.995606848200114e-05, // 1075
 1.106554507188979e-02, // 1076
 2.694537594717133e-02, // 1077
 4.975025264812929e-03, // 1078
 9.321291272904321e-02, // 1079
-1.087491265096543e-04, // 1080
 2.615883501082784e-04, // 1081
-2.429488959703926e-06, // 1082
 4.736424216221968e-04, // 1083
 1.090200519227165e-04, // 1084
-1.823884045401908e-03, // 1085
-2.404746906948975e+00, // 1086
-8.561359085087008e-03, // 1087
 3.500951762412582e-05, // 1088
-1.185482643929641e-02, // 1089
-3.657625314094979e-04, // 1090
 1.248044887579268e-03, // 1091
-2.012340749068667e-01, // 1092
 1.449216805226186e-03, // 1093
-6.419548683028071e-06, // 1094
 6.326450845498531e-04, // 1095
 2.227668140078825e-03, // 1096
 3.103285386904314e-02, // 1097
 6.113611063028055e-05, // 1098
 2.929483339067676e-04, // 1099
-2.146660664698325e-05, // 1100
-1.544338022601835e-01, // 1101
 1.310485924043465e-01, // 1102
 5.985105636948576e+00, // 1103
 1.529236187777153e+00, // 1104
-1.449323808934884e-07, // 1105
-2.054740052259233e+01, // 1106
-5.883461464136578e-05, // 1107
 3.551350340204988e-01, // 1108
 5.399733789740475e-04, // 1109
-6.312718032650090e-02, // 1110
 1.513702294154083e-01, // 1111
 2.473030895613934e-03, // 1112
 1.009890976643914e-02, // 1113
 1.052759511887624e-04, // 1114
-1.328396650003594e-03, // 1115
 9.202593663645557e-02, // 1116
-1.656341371197039e-01, // 1117
-2.297748537421769e-02, // 1118
-8.456230941045395e-03, // 1119
-2.877949588684487e+01, // 1120
-4.279149272774744e-02, // 1121
 2.676687627457522e-02, // 1122
-1.812048091492956e+01, // 1123
-7.538675569253302e-04, // 1124
 8.698242803843830e-04, // 1125
-1.605370963615683e-03, // 1126
 8.579459394541701e-02, // 1127
 4.522181000744728e-01, // 1128
 7.233955695179338e-04, // 1129
 1.145656292065364e-04, // 1130
 2.245033581314387e-01, // 1131
 7.059878970847190e-02, // 1132
-6.184311783210575e-01, // 1133
 5.659172433910398e-02, // 1134
-2.016957406257439e-04, // 1135
-1.689667954874080e-01, // 1136
 3.882212585508042e-01, // 1137
-4.377082467656366e-03, // 1138
 6.253303948523588e-04, // 1139
-2.312763278173456e-05, // 1140
 1.849436249912720e-01, // 1141
 4.661580962443574e-04, // 1142
-3.088783205832037e-01, // 1143
-2.731568970218439e-02, // 1144
-7.022221225872187e-04, // 1145
 1.394844817137756e-01, // 1146
 5.880467625729358e-03, // 1147
-1.210979012236710e-03, // 1148
-9.858323847227415e-02, // 1149
-6.144998938518012e+00, // 1150
 9.185485723556861e-01, // 1151
-1.849028028059756e-04, // 1152
 1.497898692716666e-02, // 1153
 7.676698551649448e-05, // 1154
-9.122144580002283e-06, // 1155
 3.576520997197169e-04, // 1156
 6.900106328412971e-02, // 1157
 3.382277239573916e-02, // 1158
-1.473286192861173e-04, // 1159
-7.277240079720721e-03, // 1160
 1.265073166305631e-02, // 1161
 2.694054175351195e-03, // 1162
 4.274412420508739e-06, // 1163
 1.502169839791013e-03, // 1164
 9.001572547963615e-03, // 1165
-7.719611190364950e-05, // 1166
 5.646283750487336e-03, // 1167
 3.456564127362508e-02, // 1168
-1.168160078908706e-02, // 1169
-1.226137050918556e+00, // 1170
-2.290585341278550e-05, // 1171
 1.087725032780357e-01, // 1172
-3.141026479765385e-02, // 1173
-2.124815271572326e-06, // 1174
-1.198171695748323e+00, // 1175
-6.631404810697761e-02, // 1176
-4.708163823242070e-04, // 1177
-3.865108742755595e+00, // 1178
 3.743764644729003e-01, // 1179
 3.240798402680252e-03, // 1180
-1.545642654862046e-01, // 1181
 2.325319799663544e-05, // 1182
-1.356486668217475e-05, // 1183
-1.739765831997377e-06, // 1184
 3.132217954726987e-01, // 1185
-9.106165915190548e-02, // 1186
 3.524164877153393e-02, // 1187
-2.551041598015915e-02, // 1188
 6.757736762402348e-01, // 1189
 3.449801379474812e-04, // 1190
 1.987614267851458e-04, // 1191
 1.585010327857262e+01, // 1192
-1.680794062016676e-02, // 1193
 9.590697280223409e-04, // 1194
 1.181076561055273e+00, // 1195
-9.335682346438933e-01, // 1196
-8.272707261243228e-05, // 1197
-5.887857530199807e-01, // 1198
 5.594368973558745e-01, // 1199
 1.664850737531030e-03, // 1200
 8.702145391248159e-02, // 1201
 9.476772530145734e+00, // 1202
-8.769646143574771e-01, // 1203
-5.386707118721863e-02, // 1204
 1.303769519367264e+00, // 1205
 3.337224964464148e-03, // 1206
 5.908076114489638e-01, // 1207
 3.138345555507492e+00, // 1208
-1.391033720642050e+00, // 1209
 9.371813571645393e-04, // 1210
-9.779333139546317e-03, // 1211
-5.623671929081028e-01, // 1212
-6.546523972817202e-03, // 1213
 4.643985050706218e-01, // 1214
 3.207926993093949e-01, // 1215
 8.022588423402263e-02, // 1216
-4.110847554867190e-02, // 1217
 6.836004363880962e-01, // 1218
 2.290358306613552e-06, // 1219
-1.761242146669148e-01, // 1220
-4.361680190192930e-06, // 1221
 4.759256740403986e-04, // 1222
 1.091871961143652e-04, // 1223
 1.443093694677427e-01, // 1224
 6.163787717707292e-01, // 1225
-2.582755478645911e-03, // 1226
 2.030483298297600e-05, // 1227
-1.712345961847240e-04, // 1228
-2.710845161996994e-02, // 1229
 2.430182193251524e-01, // 1230
-7.848756441131331e-02, // 1231
 6.107194653707120e-01, // 1232
-1.495130321802166e+01, // 1233
 2.486105127428567e-05, // 1234
 5.481807747314178e-03, // 1235
-2.391624337902534e-02, // 1236
-1.507285583042072e-01, // 1237
-2.041327827813804e-04, // 1238
 1.346022781743762e-03, // 1239
-6.895338535366466e-01, // 1240
 2.578361026863788e+00, // 1241
 4.269749688535244e-05, // 1242
-9.194741796346893e-06, // 1243
 2.075566105008985e-02, // 1244
-1.661233845729250e-04, // 1245
 5.526806741881075e-04, // 1246
 1.724497382829724e-01, // 1247
-5.588268788328846e-04, // 1248
 5.136336894851803e-02, // 1249
 2.069555935251387e-02, // 1250
 1.627025706670614e-06, // 1251
-3.982530533052105e-02, // 1252
 9.945276803555935e-04, // 1253
 9.553351982341983e-01, // 1254
 1.049201751716487e-01, // 1255
 2.953033479237314e-05, // 1256
-4.249918054778552e-03, // 1257
-5.190562085366042e-03, // 1258
-1.725845960964499e-02, // 1259
 7.307486356097558e-01, // 1260
 3.526248454549063e+00, // 1261
-1.109662356099987e+01, // 1262
 2.783544644846858e+00, // 1263
 3.867781126436802e-03, // 1264
-1.244881984755182e-03, // 1265
-6.111927057694694e-01, // 1266
-4.486883410018394e-03, // 1267
 3.392301398503074e-04, // 1268
 2.516519965202629e-03, // 1269
 2.809611291613576e-03, // 1270
 5.914899527268859e+00, // 1271
 5.600416783074082e-05, // 1272
-1.326457253529980e-01, // 1273
 4.713805031976270e+00, // 1274
 8.288149112593906e-03, // 1275
 8.680935392838179e-01, // 1276
-6.737231656750275e+00, // 1277
 1.546576795942015e-04, // 1278
 5.936486913256360e-04, // 1279
-3.519457563784105e-01, // 1280
-1.783189080415805e-04, // 1281
 5.985166999521272e-04, // 1282
 3.202160571815900e-05, // 1283
 1.871333186035022e+01, // 1284
 9.560291234173056e-04, // 1285
-1.590424800680788e-01, // 1286
 2.162928271095221e-01, // 1287
-1.712110309639150e-03, // 1288
 1.400100367245812e-02, // 1289
 1.876738533044466e-01, // 1290
 2.895853245920389e-02, // 1291
-1.940727201781062e+00, // 1292
-5.013023909772887e-01, // 1293
-1.132989305180649e-01, // 1294
 4.260044468611162e-02, // 1295
-3.660472608973039e+00, // 1296
-9.681283488310216e-03, // 1297
 3.463007654456968e-02, // 1298
 3.637970767456512e-04, // 1299
 3.687466167539811e-02, // 1300
 2.400601107359582e+01, // 1301
-3.155497845019290e+00, // 1302
 1.931737635858386e+01, // 1303
 7.923843447604313e-06, // 1304
 5.218247086205259e-01, // 1305
-6.014957344956637e-04, // 1306
 5.184875152326865e-02, // 1307
 1.441290471137813e-03, // 1308
 7.595337891204544e-03, // 1309
-3.841815631120372e-04, // 1310
-1.131191475165456e-05, // 1311
 6.350952802534616e-01, // 1312
-8.366687867483711e-03, // 1313
-2.637442754104329e+00, // 1314
 3.935217950776120e+01, // 1315
 2.437723946866681e-03, // 1316
 2.285637517813080e+00, // 1317
 6.083941554248726e-02, // 1318
 1.969400234134309e+01, // 1319
-5.975139442235236e-03, // 1320
-9.554745179381843e-03, // 1321
 5.297289506216835e-04, // 1322
 2.195018806622874e+00, // 1323
-4.053126045649174e+00, // 1324
-5.601214430911527e-06, // 1325
 2.030208625318618e-03, // 1326
 7.668654805020571e-01, // 1327
 5.068211246287395e-03, // 1328
-2.581109731066749e-04, // 1329
-6.981157372156339e+00, // 1330
 2.549381435061674e-04, // 1331
-1.358170897891530e-04, // 1332
-2.791374573225802e-04, // 1333
-1.015596523831193e-01, // 1334
-7.796161167740766e-02, // 1335
-5.224914535431683e-05, // 1336
 5.972521389587286e-02, // 1337
-8.304457992228844e-05, // 1338
 2.723726770603563e-03, // 1339
-2.168955622927129e+00, // 1340
-7.538565867047132e-01, // 1341
-8.282633587085643e-03, // 1342
-1.719424520534079e-01, // 1343
 7.701376217470594e-02, // 1344
 4.309315872897466e+00, // 1345
 1.008494343835661e-02, // 1346
-8.702693533464767e-05, // 1347
-2.145727377491370e+00, // 1348
-1.682193468121351e+00, // 1349
 1.724273290498588e+00, // 1350
-1.019017420100972e+00, // 1351
-2.506733623508467e-02, // 1352
 1.543474029533247e-03, // 1353
 5.629742203264740e+00, // 1354
 9.383196857444838e-01, // 1355
 1.099123801133554e-01, // 1356
 1.282497274129732e-02, // 1357
 7.631698688267516e+00, // 1358
-1.639437751361308e+01, // 1359
-5.258693417838354e-01, // 1360
-2.013361710592091e+01, // 1361
-1.135754732285444e-03, // 1362
-9.114325729217855e-01, // 1363
 3.372464896504501e-04, // 1364
-2.172672133175391e+01, // 1365
-8.097761527356312e-03, // 1366
-2.362246698562586e-01, // 1367
-1.075247880472904e-04, // 1368
 1.268265217183916e+00, // 1369
 3.290285252322115e-01, // 1370
 3.146979034202776e-05, // 1371
 8.337280034836017e-03, // 1372
-1.753917113113987e+00, // 1373
 1.601162107834806e+00, // 1374
-9.273819496327098e-01, // 1375
 3.816820204201622e-06, // 1376
 6.385648605591494e-03, // 1377
-5.135291279116097e-01, // 1378
-1.543285594523558e-01, // 1379
-2.923348795431815e-06, // 1380
-2.109089862583018e-03, // 1381
-8.131258089417229e-03, // 1382
-1.961677867379936e+00, // 1383
-1.346437171874750e+00, // 1384
-4.852738743408128e+01, // 1385
-1.357045225417376e-01, // 1386
 1.180216792226535e-03, // 1387
 8.487163587690552e-06, // 1388
 2.970409612692542e-03, // 1389
-1.349468988265236e+00, // 1390
-1.805458921110831e-01, // 1391
 3.715845767022526e-04, // 1392
 5.922822379715234e-05, // 1393
-1.583914770488925e-01, // 1394
-1.539368510871991e-02, // 1395
-4.199234831390103e-01, // 1396
 1.046313472559385e-05, // 1397
 3.370601999746783e-05, // 1398
-7.770234811191598e-05, // 1399
 3.763400259729020e-03, // 1400
-1.634921811088334e-02, // 1401
 6.735602982778577e-02, // 1402
 6.060793850489690e-02, // 1403
 3.900097881910789e-03, // 1404
-2.320652719561191e+00, // 1405
 2.583250738292269e-03, // 1406
 2.481812975982931e-01, // 1407
-1.363436802737535e-01, // 1408
-9.915742839111367e-01, // 1409
-2.100175559110904e-03, // 1410
 6.774119389169880e-02, // 1411
-2.391079027883190e-01, // 1412
 2.847522992770178e+00, // 1413
 2.224906675991711e-02, // 1414
-6.991161929717383e-05, // 1415
-8.565116349856574e-01, // 1416
 2.680742389761234e-01, // 1417
 1.077364434819532e-01, // 1418
-8.349854513332602e-02, // 1419
-9.344747466459009e-06, // 1420
 2.579301580634747e+00, // 1421
-9.910630142384249e-01, // 1422
 6.133341864941154e-04, // 1423
 1.571922534075338e-01, // 1424
-8.759836246753043e-02, // 1425
 1.128430041099155e-03, // 1426
-5.027792851641982e-05, // 1427
 2.400840761658992e-01, // 1428
 8.212157569959285e-06, // 1429
 8.205093985255372e-03, // 1430
-1.202447457237570e+01, // 1431
 8.113622600943894e-05, // 1432
 2.775103198140202e+01, // 1433
-1.538495756828789e+01, // 1434
 3.325668194381458e-01, // 1435
-2.028200269467721e+00, // 1436
-4.194490906653719e+00, // 1437
-2.049097799930442e+00, // 1438
 6.253435051323806e-01, // 1439
-1.940664773902506e-05, // 1440
-5.012075001970943e+01, // 1441
-1.109562580824359e-01, // 1442
-3.013154820333413e+00, // 1443
 9.537104175234574e-02, // 1444
 1.393567644856191e+00, // 1445
-2.835763765748037e-04, // 1446
-1.882918361538689e-03, // 1447
 7.585904071206030e-04, // 1448
 2.644026777075551e-02, // 1449
-5.124399711880147e-06, // 1450
-1.299129068120441e-02, // 1451
-1.976795264352735e+00, // 1452
-3.057040362425746e+01, // 1453
-2.083912275052900e-01, // 1454
 5.255850054980978e+00, // 1455
-3.585356254002614e-02, // 1456
 4.385752389410461e-01, // 1457
-1.329771652357956e-01, // 1458
 1.825319292467812e+00, // 1459
-2.121248337609327e-01, // 1460
 1.246728648487991e+01, // 1461
-7.647175113520824e+00, // 1462
-2.336260819068481e-01, // 1463
 2.787158912923526e-02, // 1464
-6.702723273538969e-02, // 1465
-6.068595144105863e+00, // 1466
 4.300432639786710e+00, // 1467
 2.375360280664770e-03, // 1468
 6.550290903847177e-08, // 1469
-1.753394969256465e+01, // 1470
-2.259719211277764e-05, // 1471
-1.419681237612070e+00, // 1472
-4.297086621712314e-01, // 1473
-1.737020703717496e-03, // 1474
-4.721422020245520e-04, // 1475
-3.333619135263997e-02, // 1476
 3.261418083269748e+00, // 1477
 1.516891768197958e-03, // 1478
 1.268734885334193e-06, // 1479
 4.110237801201791e-04, // 1480
 5.119008488559080e-03, // 1481
 4.622127340990455e-01, // 1482
-1.758847669041790e-01, // 1483
 2.229114808383496e+00, // 1484
-2.370216084902289e-01, // 1485
 8.729309188803387e-06, // 1486
 1.316668898290090e-01, // 1487
-2.294311132993079e-03, // 1488
 6.830465876087024e-01, // 1489
 2.632486536343544e+00, // 1490
-5.163884116556141e-01, // 1491
-2.066846707494096e+00, // 1492
 3.772914439453621e+00, // 1493
-6.474143534351401e-01, // 1494
-1.105365955488751e+00, // 1495
-6.762848242611838e-02, // 1496
-1.875816708117967e-02, // 1497
-4.221778511308658e-05, // 1498
 8.910928519002006e-01, // 1499
-8.504083116197286e-02, // 1500
-5.149110184437404e-07, // 1501
-3.759410041519150e+00, // 1502
 5.765460425733600e+00, // 1503
 4.841144954372163e-02, // 1504
 5.150691940313367e-01, // 1505
 1.289223558965195e+00, // 1506
 1.668468338377292e-03, // 1507
 1.228935104355005e-02, // 1508
-1.508793559486777e+00, // 1509
 4.067661082935186e+00, // 1510
 8.206062145646573e-01, // 1511
 1.671957342771166e+01, // 1512
 1.999361167232172e-02, // 1513
-9.676096631755789e-01, // 1514
 1.699459540718791e+00, // 1515
 1.078261240210988e-01, // 1516
-2.965698743517663e-04, // 1517
 3.150738885004698e-01, // 1518
 1.771113149567046e-05, // 1519
-6.732283897907668e-02, // 1520
-8.924032419489940e-01, // 1521
 4.927909863981897e-01, // 1522
-1.669775428857681e-04, // 1523
 1.439636871898575e+00, // 1524
-1.698736596061796e-02, // 1525
-2.630325937163018e-03, // 1526
 6.666127732407469e+00, // 1527
 7.334205914793320e-01, // 1528
-1.752995281882835e+00, // 1529
-1.896900432884842e+00, // 1530
-2.088273299721102e-06, // 1531
 2.378455327968892e-01, // 1532
-1.113626208428000e+01, // 1533
 2.932276160166742e-01, // 1534
 3.839725182179057e+00, // 1535
 2.743429404385120e+00, // 1536
 1.205512928018115e+00, // 1537
-2.045285690067859e+00, // 1538
 6.163348951538666e-01, // 1539
-8.578679227497036e-05, // 1540
 9.116821556637831e+01, // 1541
 2.065627587751124e-02, // 1542
-3.075573369129778e-01, // 1543
 1.238702006437986e-02, // 1544
-2.044163447463991e+00, // 1545
 1.854059600264341e+00, // 1546
 1.635368609636654e-03, // 1547
-2.174274001377103e+00, // 1548
-3.740126114012356e-01, // 1549
-1.197642616269313e+00, // 1550
 7.850218530321071e-01, // 1551
-3.911776884120941e-04, // 1552
 7.039747996654258e-02, // 1553
 1.375445710942239e-03, // 1554
-2.567618320569913e-02, // 1555
-9.023587708493500e-02, // 1556
-1.407461103787531e-01, // 1557
-4.661132792825803e-03, // 1558
-1.824678400418212e-01, // 1559
 5.429840410368022e-01, // 1560
 1.133376565167084e+00, // 1561
-2.059711155740709e-02, // 1562
 1.654615879124471e+00, // 1563
 2.548626460217023e+00, // 1564
-1.949305119453684e-05, // 1565
-1.062687429456725e+00, // 1566
 7.533123167193073e+00, // 1567
 6.380762525937236e-04, // 1568
-1.084860502628863e+01, // 1569
-3.330837722614133e-02, // 1570
 1.723648790980772e-02, // 1571
 1.128536862763028e-04, // 1572
 3.706985034762162e-04, // 1573
 1.045021404882263e+00, // 1574
-2.538824273060186e+00, // 1575
-1.599356732488766e-01, // 1576
-3.295455451518815e+00, // 1577
 1.791299027630664e-01, // 1578
 1.693666764129390e-01, // 1579
 6.399851751473961e+00, // 1580
-8.822821151330550e-02, // 1581
 1.829832132385303e+01, // 1582
-1.022193856624527e-04, // 1583
 9.541568323223693e-01, // 1584
 2.973335531772869e-02, // 1585
-1.955166493281415e+00, // 1586
-3.228243820195028e-01, // 1587
-2.012021193828326e+00, // 1588
-7.829036972216900e-04, // 1589
 5.870961162819411e-03, // 1590
 3.823178109574906e-02, // 1591
-1.591104493242042e-02, // 1592
-4.868695145202605e-02, // 1593
 1.960643508971780e-01, // 1594
-1.625793918098677e+00, // 1595
-2.274328690706555e-01, // 1596
 3.147933508190324e-02, // 1597
 4.169207705849355e-01, // 1598
 8.884058824711005e-04, // 1599
 1.259715683644612e-04, // 1600
 1.695541729409240e-01, // 1601
-1.968588928981440e-01, // 1602
 7.249860142159528e-01, // 1603
 1.875024249410098e-06, // 1604
-1.269094962386354e-03, // 1605
 2.369903220363059e+00, // 1606
 2.051727443452488e+01, // 1607
-1.760388323770515e+01, // 1608
 3.275455422537028e-03, // 1609
-8.058382163135833e-02, // 1610
-1.366204014769971e+00, // 1611
-3.674894413002166e-02, // 1612
-4.392999126587500e-03, // 1613
-9.793674077147245e-04, // 1614
-2.061030603455279e-01, // 1615
 4.847226094646138e-05, // 1616
 2.852691691184430e+00, // 1617
 8.611656432983130e-01, // 1618
 3.306568410954770e+01, // 1619
 2.220589445494731e+00, // 1620
 5.139309091631101e+00, // 1621
-1.013195787593158e-01, // 1622
-8.216358054271479e-02, // 1623
-1.251007609064176e-01, // 1624
 8.879184913228398e-01, // 1625
-1.184806842930702e-01, // 1626
 7.644988793078609e-01, // 1627
 2.096144912179706e+00, // 1628
-8.109357946429651e-01, // 1629
-6.294272249966510e-01, // 1630
 5.215394511326172e-03, // 1631
 1.387327668300481e+01, // 1632
 3.462761609449502e+00, // 1633
-5.438583265764246e-01, // 1634
-1.363845310616613e+00, // 1635
 5.978471676340286e+01, // 1636
-2.101473087983168e+00, // 1637
 6.893332352913555e-01, // 1638
 1.023419160473929e-02, // 1639
-3.966126149050395e-02, // 1640
-7.724929229464801e-02, // 1641
-3.692313049249781e-03, // 1642
-1.496982692473419e-01, // 1643
 7.842314019876668e+00, // 1644
 1.396400634842945e+00, // 1645
-7.079373476665619e+00, // 1646
-5.095884959814857e-02, // 1647
-3.363920043512478e+00, // 1648
-3.048388123702710e-01, // 1649
-5.154153018001081e-04, // 1650
-2.155631252910188e+00, // 1651
 2.158502945172155e-02}; // 1652

    m_d_intra_AB =  9.711475336203186e-01; // A^(-1))
    m_k_intra_AB =  2.991129377354730e+00; // A^(-1))
    m_d_intra_BB =  2.247507043695376e+00; // A^(-1))
    m_k_intra_BB =  1.776076592672980e+00; // A^(-1))
    m_d_intra_CD =  2.930193028642861e+00; // A^(-1))
    m_k_intra_CD =  8.784095840943548e-01; // A^(-1))
    m_d_intra_DD =  2.481043684198385e+00; // A^(-1))
    m_k_intra_DD =  2.220694581661451e+00; // A^(-1))
    m_d_AC =  2.730468459200360e+00; // A^(-1))
    m_k_AC =  9.760814515633827e-01; // A^(-1))
    m_d_AD =  2.711874357778875e+00; // A^(-1))
    m_k_AD =  2.671217176193513e+00; // A^(-1))
    m_d_BC =  4.665335309987695e+00; // A^(-1))
    m_k_BC =  1.206205856757539e+00; // A^(-1))
    m_d_BD =  6.043660542816871e+00; // A^(-1))
    m_k_BD =  2.879622692196830e-01; // A^(-1))
    m_d_CZ =  4.584956529773560e+00; // A^(-1))
    m_k_CZ =  1.382134149600439e+00; // A^(-1))
    m_d_DZ =  4.021523821428722e+00; // A^(-1))
    m_k_DZ =  3.624833784927413e+00; // A^(-1))

}

//----------------------------------------------------------------------------//

double x2b_A1B2Z2_C1D2_v1x::f_switch(const double& r, double& g) const
{
    if (r > m_r2f) {
        g = 0.0;
        return 0.0;
    } else if (r > m_r2i) {
        const double t1 = M_PI/(m_r2f - m_r2i);
        const double x = (r - m_r2i)*t1;
        g = - std::sin(x)*t1/2.0;
        return (1.0 + std::cos(x))/2.0;
    } else {
        g = 0.0;
        return 1.0;
    }
}

//----------------------------------------------------------------------------//

double x2b_A1B2Z2_C1D2_v1x::eval(const double* xyz1, const double* xyz2, const size_t ndim) const
{
    std::vector<double> energies(ndim,0.0);

    for (size_t j = 0; j < ndim; j++) {
        double mon1[9];
        double mon2[9];

        std::copy(xyz1 + j * 9, xyz1 + (j+1) * 9, mon1);
        std::copy(xyz2 + j * 9, xyz2 + (j+1) * 9, mon2);

        // ##DEFINE HERE## right now it assumes 1st atom of each monomer
        const double d12[3] = {mon1[0] -  mon2[0],
                               mon1[1] -  mon2[1],
                               mon1[2] -  mon2[2]};

        const double r12sq = d12[0]*d12[0] + d12[1]*d12[1] + d12[2]*d12[2];
        const double r12 = std::sqrt(r12sq);

        if (r12 > m_r2f)
            continue;

        double xcrd[18]; // coordinates of real sites ONLY

        std::copy(mon1, mon1 + 9, xcrd);
        std::copy(mon2, mon2 + 9, xcrd + 9);
        
        double v[21];
        
        double sw = 0.0;
        double gsw = 0.0;
        
        const double* A_1_a= xcrd + 0;
        const double* B_1_a= xcrd + 3;
        const double* B_2_a= xcrd + 6;

        const double* C_1_b= xcrd + 9;
        const double* D_1_b= xcrd + 12;
        const double* D_2_b= xcrd + 15;

        double Z_1_a[3];
        double Z_2_a[3];


//        vsites virt;
        double w12 =     -9.721486914088159e-02;  //from MBpol
        double w13 =     -9.721486914088159e-02;
        double wcross =   9.859272078406150e-02;

        monomer m;
        
        m.setup(A_1_a, w12, wcross,
                 Z_1_a, Z_2_a);
                        
        variable vr[21];
        
        v[0]  = vr[0].v_exp(m_d_intra_AB, m_k_intra_AB, A_1_a, B_1_a);
        v[1]  = vr[1].v_exp(m_d_intra_AB, m_k_intra_AB, A_1_a, B_2_a);
        v[2]  = vr[2].v_exp(m_d_intra_BB, m_k_intra_BB, B_1_a, B_2_a);

        v[3]  = vr[3].v_exp(m_d_intra_CD, m_k_intra_CD, C_1_b, D_1_b);
        v[4]  = vr[4].v_exp(m_d_intra_CD, m_k_intra_CD, C_1_b, D_2_b);
        v[5]  = vr[5].v_exp(m_d_intra_DD, m_k_intra_DD, D_1_b, D_2_b);

        v[6]  = vr[6].v_exp(m_d_AC, m_k_AC, A_1_a, C_1_b);
        v[7]  = vr[7].v_exp(m_d_AD, m_k_AD, A_1_a, D_1_b);
        v[8]  = vr[8].v_exp(m_d_AD, m_k_AD, A_1_a, D_2_b);

        v[9]  = vr[9].v_exp(m_d_BC, m_k_BC, B_1_a, C_1_b);
        v[10]  = vr[10].v_exp(m_d_BD, m_k_BD, B_1_a, D_1_b);
        v[11]  = vr[11].v_exp(m_d_BD, m_k_BD, B_1_a, D_2_b);

        v[12]  = vr[12].v_exp(m_d_BC, m_k_BC, B_2_a, C_1_b);
        v[13]  = vr[13].v_exp(m_d_BD, m_k_BD, B_2_a, D_1_b);
        v[14]  = vr[14].v_exp(m_d_BD, m_k_BD, B_2_a, D_2_b);

        v[15]  = vr[15].v_exp(m_d_CZ, m_k_CZ, Z_1_a, C_1_b);
        v[16]  = vr[16].v_exp(m_d_DZ, m_k_DZ, Z_1_a, D_1_b);
        v[17]  = vr[17].v_exp(m_d_DZ, m_k_DZ, Z_1_a, D_2_b);

        v[18]  = vr[18].v_exp(m_d_CZ, m_k_CZ, Z_2_a, C_1_b);
        v[19]  = vr[19].v_exp(m_d_DZ, m_k_DZ, Z_2_a, D_1_b);
        v[20]  = vr[20].v_exp(m_d_DZ, m_k_DZ, Z_2_a, D_2_b);

         
        
        sw = f_switch(r12, gsw);
        
        energies[j] = sw*polynomial::eval(coefficients.data(), v);
    }

    double energy = 0.0;
    for (size_t i = 0; i < ndim; i++) {
      energy += energies[i];
    }

    return energy;
        
}

double x2b_A1B2Z2_C1D2_v1x::eval(const double* xyz1, const double* xyz2,
                double * grad1, double * grad2, const size_t ndim, std::vector<double> *virial) const
{
    std::vector<double> energies(ndim,0.0);

    for (size_t j = 0; j < ndim; j++) {
        double mon1[9];
        double mon2[9];

        std::copy(xyz1 + j * 9, xyz1 + (j+1) * 9, mon1);
        std::copy(xyz2 + j * 9, xyz2 + (j+1) * 9, mon2);
    
 
        // ##DEFINE HERE## right now it assumes 1st atom of each monomer
        const double d12[3] = {mon1[0] -  mon2[0],
                               mon1[1] -  mon2[1],
                               mon1[2] -  mon2[2]};
    
        const double r12sq = d12[0]*d12[0] + d12[1]*d12[1] + d12[2]*d12[2];
        const double r12 = std::sqrt(r12sq);
    
        if (r12 > m_r2f)
            continue;
    
        double xcrd[18]; // coordinates of real sites ONLY
    
        std::copy(mon1, mon1 + 9, xcrd);
        std::copy(mon2, mon2 + 9, xcrd + 9);
        
        double v[21];
        
        double sw = 0.0;
        double gsw = 0.0;
        
        const double* A_1_a= xcrd + 0;
        const double* B_1_a= xcrd + 3;
        const double* B_2_a= xcrd + 6;
    
        const double* C_1_b= xcrd + 9;
        const double* D_1_b= xcrd + 12;
        const double* D_2_b= xcrd + 15;
    
        double Z_1_a[3];
        double Z_2_a[3];
    
    
        //vsites virt;
        double w12 =     -9.721486914088159e-02;  //from MBpol
        double w13 =     -9.721486914088159e-02;
        double wcross =   9.859272078406150e-02;
    
        monomer m;
        
        m.setup(A_1_a, w12, wcross, 
                 Z_1_a, Z_2_a);
                        
        variable vr[21];
        
        v[0]  = vr[0].v_exp(m_d_intra_AB, m_k_intra_AB, A_1_a, B_1_a);
        v[1]  = vr[1].v_exp(m_d_intra_AB, m_k_intra_AB, A_1_a, B_2_a);
        v[2]  = vr[2].v_exp(m_d_intra_BB, m_k_intra_BB, B_1_a, B_2_a);
    
        v[3]  = vr[3].v_exp(m_d_intra_CD, m_k_intra_CD, C_1_b, D_1_b);
        v[4]  = vr[4].v_exp(m_d_intra_CD, m_k_intra_CD, C_1_b, D_2_b);
        v[5]  = vr[5].v_exp(m_d_intra_DD, m_k_intra_DD, D_1_b, D_2_b);
    
        v[6]  = vr[6].v_exp(m_d_AC, m_k_AC, A_1_a, C_1_b);
        v[7]  = vr[7].v_exp(m_d_AD, m_k_AD, A_1_a, D_1_b);
        v[8]  = vr[8].v_exp(m_d_AD, m_k_AD, A_1_a, D_2_b);
    
        v[9]  = vr[9].v_exp(m_d_BC, m_k_BC, B_1_a, C_1_b);
        v[10]  = vr[10].v_exp(m_d_BD, m_k_BD, B_1_a, D_1_b);
        v[11]  = vr[11].v_exp(m_d_BD, m_k_BD, B_1_a, D_2_b);
    
        v[12]  = vr[12].v_exp(m_d_BC, m_k_BC, B_2_a, C_1_b);
        v[13]  = vr[13].v_exp(m_d_BD, m_k_BD, B_2_a, D_1_b);
        v[14]  = vr[14].v_exp(m_d_BD, m_k_BD, B_2_a, D_2_b);
    
        v[15]  = vr[15].v_exp(m_d_CZ, m_k_CZ, Z_1_a, C_1_b);
        v[16]  = vr[16].v_exp(m_d_DZ, m_k_DZ, Z_1_a, D_1_b);
        v[17]  = vr[17].v_exp(m_d_DZ, m_k_DZ, Z_1_a, D_2_b);
    
        v[18]  = vr[18].v_exp(m_d_CZ, m_k_CZ, Z_2_a, C_1_b);
        v[19]  = vr[19].v_exp(m_d_DZ, m_k_DZ, Z_2_a, D_1_b);
        v[20]  = vr[20].v_exp(m_d_DZ, m_k_DZ, Z_2_a, D_2_b);
    
         
        
        double g[21];
        
        // the switch
        
        sw = f_switch(r12, gsw);
        energies[j] = polynomial::eval(coefficients.data(), v, g);
        
        double xgrd[24];
        std::fill(xgrd, xgrd + 24, 0.0);
    
        double* A_1_a_g = xgrd + 0;
        double* B_1_a_g = xgrd + 3;
        double* B_2_a_g = xgrd + 6;
    
        double* C_1_b_g = xgrd + 9;
        double* D_1_b_g = xgrd + 12;
        double* D_2_b_g = xgrd + 15;
    
        double* Z_1_a_g = xgrd + 18;
        double* Z_2_a_g = xgrd + 21;
    
        vr[0].grads(g[0], A_1_a_g, B_1_a_g, A_1_a, B_1_a);
        vr[1].grads(g[1], A_1_a_g, B_2_a_g, A_1_a, B_2_a);
        vr[2].grads(g[2], B_1_a_g, B_2_a_g, B_1_a, B_2_a);
    
        vr[3].grads(g[3], C_1_b_g, D_1_b_g, C_1_b, D_1_b);
        vr[4].grads(g[4], C_1_b_g, D_2_b_g, C_1_b, D_2_b);
        vr[5].grads(g[5], D_1_b_g, D_2_b_g, D_1_b, D_2_b);
    
        vr[6].grads(g[6], A_1_a_g, C_1_b_g, A_1_a, C_1_b);
        vr[7].grads(g[7], A_1_a_g, D_1_b_g, A_1_a, D_1_b);
        vr[8].grads(g[8], A_1_a_g, D_2_b_g, A_1_a, D_2_b);
    
        vr[9].grads(g[9], B_1_a_g, C_1_b_g, B_1_a, C_1_b);
        vr[10].grads(g[10], B_1_a_g, D_1_b_g, B_1_a, D_1_b);
        vr[11].grads(g[11], B_1_a_g, D_2_b_g, B_1_a, D_2_b);
    
        vr[12].grads(g[12], B_2_a_g, C_1_b_g, B_2_a, C_1_b);
        vr[13].grads(g[13], B_2_a_g, D_1_b_g, B_2_a, D_1_b);
        vr[14].grads(g[14], B_2_a_g, D_2_b_g, B_2_a, D_2_b);
    
        vr[15].grads(g[15], Z_1_a_g, C_1_b_g, Z_1_a, C_1_b);
        vr[16].grads(g[16], Z_1_a_g, D_1_b_g, Z_1_a, D_1_b);
        vr[17].grads(g[17], Z_1_a_g, D_2_b_g, Z_1_a, D_2_b);
    
        vr[18].grads(g[18], Z_2_a_g, C_1_b_g, Z_2_a, C_1_b);
        vr[19].grads(g[19], Z_2_a_g, D_1_b_g, Z_2_a, D_1_b);
        vr[20].grads(g[20], Z_2_a_g, D_2_b_g, Z_2_a, D_2_b);
    
    
    
        // ##DEFINE HERE## the redistribution of the gradients
        
    
        m.grads(Z_1_a_g, Z_2_a_g, 
                 w12, wcross, A_1_a_g);
        
        
        
        for (int i = 0; i < 9; ++i) {
            xgrd[i] *= sw;
        }
    
        for (int i = 0; i < 9; ++i) {
            xgrd[i + 9] *= sw;
        }
    
        // gradient of the switch
    
        gsw *= energies[j]/r12;
        energies[j] *= sw;
        for (int i = 0; i < 3; ++i) {
            const double d = gsw*d12[i];
            xgrd[i] += d;
            xgrd[i + 9] -= d;
        }

        
        for (int i = 0; i < 9; ++i) {
            grad1[i + j*9] += xgrd[i];
        }
    
        for (int i = 0; i < 9; ++i) {
            grad2[i + j*9] += xgrd[i + 9];
        }
    
        if (virial != 0) {

            (*virial)[0] += -A_1_a[0] * A_1_a_g[0]
                            -B_1_a[0] * B_1_a_g[0]
                            -B_2_a[0] * B_2_a_g[0]
                            -C_1_b[0] * C_1_b_g[0]
                            -D_1_b[0] * D_1_b_g[0]
                            -D_2_b[0] * D_2_b_g[0];

            (*virial)[1] += -A_1_a[0] * A_1_a_g[1]
                            -B_1_a[0] * B_1_a_g[1]
                            -B_2_a[0] * B_2_a_g[1]
                            -C_1_b[0] * C_1_b_g[1]
                            -D_1_b[0] * D_1_b_g[1]
                            -D_2_b[0] * D_2_b_g[1];

            (*virial)[2] += -A_1_a[0] * A_1_a_g[2]
                            -B_1_a[0] * B_1_a_g[2]
                            -B_2_a[0] * B_2_a_g[2]
                            -C_1_b[0] * C_1_b_g[2]
                            -D_1_b[0] * D_1_b_g[2]
                            -D_2_b[0] * D_2_b_g[2];

            (*virial)[4] += -A_1_a[1] * A_1_a_g[1]
                            -B_1_a[1] * B_1_a_g[1]
                            -B_2_a[1] * B_2_a_g[1]
                            -C_1_b[1] * C_1_b_g[1]
                            -D_1_b[1] * D_1_b_g[1]
                            -D_2_b[1] * D_2_b_g[1];

            (*virial)[5] += -A_1_a[1] * A_1_a_g[2]
                            -B_1_a[1] * B_1_a_g[2]
                            -B_2_a[1] * B_2_a_g[2]
                            -C_1_b[1] * C_1_b_g[2]
                            -D_1_b[1] * D_1_b_g[2]
                            -D_2_b[1] * D_2_b_g[2];

            (*virial)[8] += -A_1_a[2] * A_1_a_g[2]
                            -B_1_a[2] * B_1_a_g[2]
                            -B_2_a[2] * B_2_a_g[2]
                            -C_1_b[2] * C_1_b_g[2]
                            -D_1_b[2] * D_1_b_g[2]
                            -D_2_b[2] * D_2_b_g[2];

            (*virial)[3] = (*virial)[1];
            (*virial)[6] = (*virial)[2];
            (*virial)[7] = (*virial)[5];



        }

    }

    double energy = 0.0;
    for (size_t i = 0; i < ndim; i++) {
      energy += energies[i];
    }

    return energy;
}

} // namespace x2b_A1B2Z2_C1D2

////////////////////////////////////////////////////////////////////////////////
